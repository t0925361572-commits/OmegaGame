<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>歐米伽訓練遊戲（V9.8）</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#f5f6fa;color:#222;margin:0;padding:20px;text-align:center}
  .container{max-width:760px;margin:0 auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
  h1{margin:0 0 8px;font-size:20px;color:#007bff}
  p.lead{margin:6px 0 12px;color:#555}
  #questionBox{min-height:80px;border-radius:8px;background:#fafafa;padding:14px;margin-bottom:12px;border:1px solid #eee;text-align:left;white-space:pre-line}
  #qmeta{font-size:13px;color:#666;margin-bottom:6px}
  #qtext{font-size:18px;line-height:1.5}
  .controls{display:flex;gap:8px;justify-content:center;margin-top:12px;flex-wrap:wrap}
  .answer-btn{background:#17a2b8;color:#fff;border:none;padding:12px 24px;border-radius:6px;cursor:pointer;font-size:18px;font-weight:bold;min-width: 80px;}
  .answer-btn:hover{background:#138496}
  .answer-btn:disabled{background:#6c757d;cursor:not-allowed;}
  
  button{background:#007bff;color:#fff;border:none;padding:10px 14px;border-radius:6px;cursor:pointer;font-size:15px;transition:background .2s}
  button:hover{background:#0056b3}
  button:disabled{background:#6c757d;cursor:not-allowed}
  button.secondary{background:#6c757d}
  button.secondary:hover{background:#5a6268}
  #score{font-size:18px;color:#007bff;margin-top:10px}
  #progress{width:100%;height:12px;background:#e9ecef;border-radius:10px;margin-top:8px;overflow:hidden}
  #progressBar{height:100%;width:0%;transition:width .3s;background:#28a745}
  #feedback{margin-top:10px;min-height:30px}
  .ok{color:#198754;background:#e7f7e7;padding:8px;border-radius:6px;border:1px solid #198754;display:inline-block}
  .bad{color:#c82333;background:#fde8e8;padding:8px;border-radius:6px;border:1px solid #c82333;display:inline-block}
  footer{margin-top:14px;font-size:13px;color:#666;text-align:center;}
  @media(max-width:520px){.answer-btn{padding:10px 20px;font-size:16px;}}
</style>
</head>
<body>
<div class="container">
  <h1>歐米伽訓練遊戲（V9.8）</h1>
  <p class="lead">每輪 5 題 • 點擊 A 或 B 按鈕答題 • **5 題全對才算通過一輪**</p>

  <div id="questionBox">
    <div id="qmeta">按「開始」抽題</div>
    <div id="qtext">準備好了嗎？</div>
  </div>

  <div class="controls">
    <button id="btnA" class="answer-btn" disabled>A</button>
    <button id="btnB" class="answer-btn" disabled>B</button>
  </div>
  <div class="controls" style="margin-top: 16px;">
    <button id="startBtn">開始 / 抽新題</button>
    <button id="reportBtn" class="secondary">下載錯題報告</button>
  </div>

  <div id="score">本輪分數：<span id="scoreVal">0</span>/5</div>
  <div id="progress"><div id="progressBar"></div></div>
  <div id="feedback"></div>

  <footer>
    總輪次：<span id="totalRounds">0</span>
  </footer>
</div>

<script>
/* V9.7 — 簡化版：移除「已通過批次」顯示，僅保留總輪次 */
const allQuestions = [
  // === 原100題（維持）===
  {q:"哪個系列以登月故事聞名？\nA. 海馬  B. 超霸", a:"B"},
  {q:"潛水性能最強的系列是哪個？\nA. 超霸  B. 海馬", a:"B"},
  {q:"星座系列的標誌性設計是？\nA. 托爪  B. 排氦閥門", a:"A"},
  {q:"碟飛系列主要訴求是？\nA. 正裝優雅  B. 運動耐用", a:"A"},
  {q:"Aqua Terra 屬於哪個主要系列？\nA. 超霸  B. 海馬", a:"B"},
  {q:"哪個系列常見於賽車/計時主題？\nA. 超霸  B. 星座", a:"A"},
  {q:"METAS 認證對應哪種標示？\nA. COSC  B. Master Chronometer", a:"B"},
  {q:"8900 機芯常見於哪個系列？\nA. 星座  B. 超霸", a:"A"},
  {q:"8800 機芯的動力儲存約為？\nA. 約55小時  B. 約72小時", a:"A"},
  {q:"3861 機芯現代化後屬於哪系列？\nA. 超霸  B. 星座", a:"A"},
  {q:"潛水錶常見功能是？\nA. 排氦閥門  B. 測速圈", a:"A"},
  {q:"超霸的經典錶圈顯著為？\nA. 排氦閥門  B. 測速圈", a:"B"},
  {q:"Aqua Terra 常見面盤裝飾是？\nA. 木紋  B. 波浪紋", a:"A"},
  {q:"Planet Ocean 常見防水等級是？\nA. 是（深潛導向）  B. 否", a:"A"},
  {q:"旋入式錶冠的目的是？\nA. 美觀  B. 提升防水", a:"B"},
  {q:"METAS 抗磁標準常見為？\nA. 5,000 高斯  B. 15,000 高斯", a:"B"},
  {q:"COSC 是下列哪項？\nA. 天文台認證  B. 抗磁測試", a:"A"},
  {q:"商務正裝錶較適合哪系列？\nA. 碟飛/星座  B. 超霸", a:"A"},
  {q:"推薦潛水愛好者佩戴哪系列？\nA. 星座  B. 海馬", a:"B"},
  {q:"Hesalite 玻璃常見於？\nA. 超霸經典款  B. 現代陶瓷款", a:"A"},
  {q:"排氦閥主要用於？\nA. 飽和潛水時排氣  B. 計時使用", a:"A"},
  {q:"Planet Ocean 常見防水為？\nA. 600 米  B. 100 米", a:"A"},
  {q:"超霸計時按鈕通常位於？\nA. 2點與4點  B. 12點", a:"A"},
  {q:"Teak 木紋面盤常見於？\nA. Aqua Terra  B. Planet Ocean", a:"A"},
  {q:"Co-Axial 擒縱的主要好處？\nA. 減少摩擦延長保養  B. 增加重量", a:"A"},
  {q:"雙發條盒帶來什麼？\nA. 延長動力儲存  B. 降低振幅", a:"A"},
  {q:"超霸與哪年代太空任務密切相關？\nA. 1960s  B. 1980s", a:"A"},
  {q:"Omega 的符號是？\nA. 鯊魚  B. 希臘字母 Ω", a:"B"},
  {q:"Master Chronometer 測試項目數量約？\nA. 8 項  B. 3 項", a:"A"},
  {q:"海馬系列主要客群為？\nA. 潛水/運動者  B. 正裝族", a:"A"},
  {q:"星座系列風格以何為主？\nA. 優雅正裝  B. 運動風", a:"A"},
  {q:"碟飛系列風格？\nA. 極簡優雅  B. 工具錶", a:"A"},
  {q:"Planet Ocean 常見表圈材質是？\nA. 陶瓷  B. 皮革", a:"A"},
  {q:"海馬 300（Seamaster 300）屬於？\nA. 復刻潛水款  B. 正裝款", a:"A"},
  {q:"Globemaster 面盤特徵俗稱？\nA. 鬆餅紋  B. 同心圓紋", a:"A"},
  {q:"Co-Axial 擒縱的發明者是？\nA. George Daniels  B. Abraham-Louis Breguet", a:"A"},
  {q:"3861 與 1861 的關鍵差異為？\nA. 同軸＆抗磁化升級  B. 僅外觀差異", a:"A"},
  {q:"某些海馬機芯動力是否達 60 小時？\nA. 否  B. 是", a:"B"},
  {q:"METAS 精準標準通常宣稱？\nA. 0/+5 秒  B. -4/+6 秒", a:"A"},
  {q:"COSC 的精準標準為？\nA. 0/+5 秒  B. -4/+6 秒", a:"B"},
  {q:"Globemaster 的認證為？\nA. COSC  B. METAS", a:"B"},
  {q:"碟飛入門款通常有 METAS 認證？\nA. 是  B. 否", a:"B"},
  {q:"碟飛適合何場合？\nA. 潛水  B. 正裝/商務", a:"B"},
  {q:"星座常見尺寸範圍為？\nA. 40–50 mm  B. 25–41 mm", a:"B"},
  {q:"海馬常見潛水功能為？\nA. 測速圈  B. 排氦閥門", a:"B"},
  {q:"碟飛強調哪種設計？\nA. 防水  B. 極簡純粹美學", a:"B"},
  {q:"超霸常見防水深度？\nA. 300 米  B. 50 米", a:"B"},
  {q:"星座錶圈近年常用材質？\nA. 皮革  B. 陶瓷/金屬", a:"B"},
  {q:"Globemaster 錶圈樣式是？\nA. 鋸齒式  B. 平滑圈", a:"A"},
  {q:"METAS 抗磁要求為？\nA. 5,000 高斯  B. 15,000 高斯", a:"B"},
  {q:"Master Chronometer 的驗證由何單位負責？\nA. METAS  B. COSC", a:"A"},
  {q:"碟飛較高端的抗磁標示常為？\nA. 5,000 高斯  B. 15,000 高斯", a:"B"},
  {q:"Globemaster 首發年份近於？\nA. 2015  B. 2010", a:"A"},
  {q:"星座 METAS 認證大約從哪年推廣？\nA. 2010  B. 2015", a:"B"},
  {q:"星座常用小秒針機芯型號為？\nA. 8900  B. 8800", a:"B"},
  {q:"星座是否適合年輕白領？\nA. 否  B. 是", a:"B"},
  {q:"Aqua Terra 名稱意涵為？\nA. 水與陸  B. 天與海", a:"A"},
  {q:"Planet Ocean 的單向表圈通常為？\nA. 單向  B. 雙向", a:"A"},
  {q:"碟飛 Prestige 常見動力為？\nA. 石英  B. 機械", a:"B"},
  {q:"Moonwatch 傳統上使用哪種鏡面？\nA. Hesalite  B. 藍寶石", a:"A"},
  {q:"Diver 300M 常搭配何種表圈材質？\nA. 陶瓷  B. 鋼", a:"A"},
  {q:"托爪（claws）原意為？\nA. 固定錶殼/玻璃  B. 固定錶帶", a:"A"},
  {q:"METAS 測試中哪項較具代表性？\nA. 抗磁  B. 溫度", a:"A"},
  {q:"Planet Ocean 常見直徑範圍之一？\nA. 39.5 mm  B. 45.5 mm", a:"B"},
  {q:"Omega 的國家起源？\nA. 瑞士  B. 德國", a:"A"},
  {q:"Co-Axial 最初商用約在？\nA. 1999 年  B. 2005 年", a:"A"},
  {q:"METAS 認證前通常要先通過？\nA. COSC  B. 防水測試", a:"A"},
  {q:"Dark Side of the Moon 系列主要材質？\nA. 陶瓷  B. 鋼", a:"A"},
  {q:"Aqua Terra GMT 的功能為？\nA. 第二時區  B. 計時碼表", a:"A"},
  {q:"星座是否提供男女款？\nA. 是  B. 否", a:"A"},
  {q:"Trésor 系列主打族群為？\nA. 年輕族群  B. 潛水員", a:"A"},
  {q:"Planet Ocean 的排氦閥常見位置？\nA. 10 點鐘  B. 8 點鐘", a:"A"},
  {q:"Diver 300M 波浪紋面盤在何時復刻流行？\nA. 2018  B. 2020", a:"A"},
  {q:"Globemaster 錶背常見圖樣為？\nA. 天文台標誌  B. 海馬", a:"A"},
  {q:"Ladymatic 系列定位為？\nA. 女錶  B. 男錶", a:"A"},
  {q:"Aqua Terra 面盤靈感源於？\nA. 遊艇甲板  B. 海浪", a:"A"},
  {q:"Diver 300M 的官方防水等級為？\nA. 300 米  B. 600 米", a:"A"},
  {q:"星座的外觀靈感常與何者連結？\nA. 羅馬建築  B. 天文台/星象", a:"B"},
  {q:"Reduced 系列的特點通常是？\nA. 自動上鍊  B. 更小尺寸減薄", a:"B"},
  {q:"Trésor 常見日期窗位置？\nA. 3 點鐘  B. 6 點鐘", a:"A"},
  {q:"Aqua Terra 常見防水標示為？\nA. 150 米  B. 300 米", a:"A"},
  {q:"星座男女款的主要差異通常是？\nA. 尺寸  B. 機芯", a:"A"},
  {q:"超霸的專業款機芯型號之一？\nA. 3861  B. 8500", a:"A"},
  {q:"METAS 測試週期大約為？\nA. 約10天  B. 約3天", a:"A"},
  {q:"Seamaster 300 Heritage 屬於？\nA. 復刻款  B. 全新設計款", a:"A"},
  {q:"Co-Axial 名稱來自於？\nA. 擒縱機構  B. 錶殼造型", a:"A"},
  {q:"Globemaster 與星座家族關係為？\nA. 同家族一員  B. 完全獨立", a:"A"},
  {q:"星座托爪首次出現年代大約？\nA. 1982  B. 1995", a:"A"},
  {q:"Aqua Terra 小秒款較新推出於？\nA. 2022  B. 2020", a:"A"},
  {q:"Omega 建廠年份為？\nA. 1848  B. 1900", a:"A"},
  {q:"超霸 Moonwatch 曾由何機構使用於任務？\nA. NASA  B. ESA", a:"A"},
  {q:"Omega 的英文常見念法？\nA. Oh-mega  B. O-mega", a:"A"},
  {q:"某些海馬型號廣受潛水員喜愛，主要因？\nA. 高防水與耐用  B. 僅外觀", a:"A"},
  {q:"星座 Globemaster 名稱來源與何相關？\nA. 天文台  B. 潛水", a:"A"},
  {q:"Snoopy Award 超霸錶是為了紀念哪次任務？\nA. 阿波羅13號  B. 阿波羅11號", a:"A"},
  {q:"Omega 是哪個集團旗下的品牌？\nA. Swatch Group  B. LVMH", a:"A"},

  // === 新增200題（基於教材完整生成）===
  {q:"OMEGA 前身工作室創立於何年？\nA. 1848  B. 1894", a:"A"},
  {q:"命名 'Omega' 的機芯為？\nA. 19令機芯  B. 1861機芯", a:"A"},
  {q:"希臘字母 Ω 象徵什麼？\nA. 完美與成就  B. 速度與海洋", a:"A"},
  {q:"1931年日內瓦天文台競賽，OMEGA 在幾類別獲第一？\nA. 3類  B. 6類", a:"B"},
  {q:"OMEGA 首度為奧運計時於何年？\nA. 1928  B. 1932", a:"B"},
  {q:"超霸通過NASA測試年份？\nA. 1965  B. 1969", a:"A"},
  {q:"巴茲・艾德林踏月時佩戴何錶？\nA. 海馬  B. 超霸", a:"B"},
  {q:"阿波羅13號任務中超霸計時幾秒？\nA. 10秒  B. 14秒", a:"B"},
  {q:"OMEGA 獲 '史努比獎' 年份？\nA. 1969  B. 1970", a:"B"},
  {q:"史上第一款商業潛水錶 'Marine' 推出年？\nA. 1932  B. 1948", a:"A"},
  {q:"馬里亞納海溝深處探險年份？\nA. 2019  B. 2020", a:"A"},
  {q:"Planet Ocean Ultra Deep 防水深度？\nA. 6000米  B. 10000米", a:"A"},
  {q:"超霸系列別稱？\nA. 月球錶  B. 海洋錶", a:"A"},
  {q:"超霸 Moonwatch Professional 機芯？\nA. 3861  B. 8800", a:"A"},
  {q:"超霸經典錶殼特徵？\nA. 非對稱  B. 對稱", a:"A"},
  {q:"Dark Side of the Moon 材質？\nA. 陶瓷  B. 鋼", a:"A"},
  {q:"海馬系列核心精神？\nA. 海洋潛水  B. 太空探險", a:"A"},
  {q:"Diver 300M 升級年份？\nA. 2018  B. 2020", a:"A"},
  {q:"Diver 300M 機芯？\nA. 8800  B. 3861", a:"A"},
  {q:"Diver 300M 錶徑？\nA. 41mm  B. 42mm", a:"B"},
  {q:"星座系列標誌？\nA. 托爪  B. 測速圈", a:"A"},
  {q:"碟飛系列定位？\nA. 正裝優雅  B. 運動耐用", a:"A"},
  {q:"Co-Axial 發明者？\nA. George Daniels  B. Louis Brandt", a:"A"},
  {q:"Co-Axial 商用年份？\nA. 1999  B. 2005", a:"A"},
  {q:"Master Chronometer 由誰創立？\nA. OMEGA與METAS  B. COSC", a:"A"},
  {q:"METAS 抗磁標準？\nA. 15,000高斯  B. 5,000高斯", a:"A"},
  {q:"Si14 矽游絲好處？\nA. 抗磁抗震  B. 增加重量", a:"A"},
  {q:"Sedna™ Gold 是什麼？\nA. 18K玫瑰金合金  B. 陶瓷", a:"A"},
  {q:"Diver 300M 面盤裝飾？\nA. 雷射波浪紋  B. 木紋", a:"A"},
  {q:"Planet Ocean 防水？\nA. 600米  B. 300米", a:"A"},
  {q:"Aqua Terra 面盤靈感？\nA. 遊艇甲板  B. 月球表面", a:"A"},
  {q:"Moonwatch 鏡面選擇？\nA. Hesalite或藍寶石  B. 僅陶瓷", a:"A"},
  {q:"Globemaster 面盤俗稱？\nA. 鬆餅紋  B. 波浪紋", a:"A"},
  {q:"超霸 ’57 推出年？\nA. 2013  B. 2021", a:"A"},
  {q:"Seamaster 300 防水？\nA. 300米  B. 150米", a:"A"},
  {q:"Ploprof 防水？\nA. 1200米  B. 600米", a:"A"},
  {q:"Trésor 尺寸範圍？\nA. 36-40mm  B. 42mm", a:"A"},
  {q:"Constellation 星標？\nA. 金星  B. 銀星", a:"A"},
  {q:"Calibre 3861 動力儲存？\nA. 50小時  B. 55小時", a:"A"},
  {q:"METAS 測試項目？\nA. 8項  B. 5項", a:"A"},
  {q:"Omega 創始人？\nA. Louis Brandt  B. George Daniels", a:"A"},
  {q:"奧運計時從何開始？\nA. 洛杉磯奧運  B. 倫敦奧運", a:"A"},
  {q:"1932年奧運使用何種計時設備？\nA. 手動碼錶  B. 電子計時", a:"A"},
  {q:"OMEGA 登月錶通過幾項NASA測試？\nA. 6項  B. 10項", a:"B"},
  {q:"阿波羅13號引擎點火計時由誰完成？\nA. 地面控制  B. 太空人手動", a:"B"},
  {q:"史努比獎是NASA頒發的？\nA. 最高榮譽  B. 一般獎項", a:"A"},
  {q:"五大洋深處探險潛水器名稱？\nA. Limiting Factor  B. Deepsea Challenger", a:"A"},
  {q:"Ultra Deep 錶款使用何種鋼材？\nA. O-MEGASTEEL  B. 鈦合金", a:"A"},
  {q:"超霸系列最早推出年份？\nA. 1957  B. 1965", a:"A"},
  {q:"Moonwatch 階梯式面盤是？\nA. 經典設計  B. 現代設計", a:"A"},
  {q:"Dark Side of the Moon 機芯？\nA. 自動上鏈  B. 手動上鏈", a:"A"},
  {q:"海馬系列最早潛水錶年份？\nA. 1948  B. 1932", a:"B"},
  {q:"Diver 300M 25週年改款年？\nA. 2018  B. 2019", a:"A"},
  {q:"Diver 300M 排氦閥形狀？\nA. 圓錐形  B. 圓形", a:"A"},
  {q:"藍色陶瓷面盤最受歡迎？\nA. Diver 300M  B. Planet Ocean", a:"A"},
  {q:"Planet Ocean 黑橘配色是？\nA. 經典設計  B. 限量設計", a:"A"},
  {q:"Aqua Terra 柚木面盤靈感？\nA. 遊艇甲板  B. 木製地板", a:"A"},
  {q:"Co-Axial 減少潤滑油需求？\nA. 是  B. 否", a:"A"},
  {q:"大師天文台認證需先通過？\nA. COSC  B. ISO", a:"A"},
  {q:"Si14 矽游絲完全抗磁？\nA. 是  B. 否", a:"A"},
  {q:"Liquidmetal™ 用於？\nA. 錶圈刻度  B. 指針", a:"A"},
  {q:"Sedna™ Gold 色澤如何？\nA. 溫潤不褪色  B. 閃亮金黃", a:"A"},
  {q:"Diver 300M 錶帶選擇？\nA. 橡膠與精鋼  B. 僅皮革", a:"A"},
  {q:"Planet Ocean 39.5mm 適合？\nA. 日常佩戴  B. 專業潛水", a:"A"},
  {q:"Moonwatch 2021升級重點？\nA. 3861機芯  B. 防水提升", a:"A"},
  {q:"超霸38mm系列主打？\nA. 小巧優雅  B. 專業計時", a:"A"},
  {q:"卡布奇諾款屬於？\nA. 超霸38mm  B. 星座", a:"A"},
  {q:"星座系列托爪功能？\nA. 固定錶鏡  B. 裝飾", a:"A"},
  {q:"碟飛系列強調？\nA. 極簡美學  B. 複雜功能", a:"A"},
  {q:"METAS 測試包含日常佩戴情境？\nA. 是  B. 否", a:"A"},
  {q:"OMEGA 四大系列不包含？\nA. 超霸  B. 鐵霸", a:"B"},
  {q:"超霸計時碼表按鈕數？\nA. 2個  B. 3個", a:"A"},
  {q:"海馬系列防水等級最高？\nA. 6000米  B. 300米", a:"A"},
  {q:"星座系列有無潛水款？\nA. 無  B. 有", a:"A"},
  {q:"碟飛系列適合搭配？\nA. 西裝  B. 潛水衣", a:"A"},
  {q:"Co-Axial 擒縱保養週期？\nA. 更長  B. 更短", a:"A"},
  {q:"大師天文台認證抗磁？\nA. 15,000高斯  B. 1,000高斯", a:"A"},
  {q:"Diver 300M 錶圈材質？\nA. 陶瓷  B. 鋁", a:"A"},
  {q:"Aqua Terra 常見尺寸？\nA. 41mm  B. 45mm", a:"A"},
  {q:"Moonwatch Hesalite 鏡面特點？\nA. 防碎  B. 防刮", a:"A"},
  {q:"超霸非對稱錶殼原因？\nA. 保護按鈕  B. 美觀", a:"A"},
  {q:"Planet Ocean 排氦閥位置？\nA. 10點鐘  B. 2點鐘", a:"A"},
  {q:"星座系列有無計時碼表？\nA. 無  B. 有", a:"A"},
  {q:"碟飛系列有無潛水功能？\nA. 無  B. 有", a:"A"},
  {q:"OMEGA 抗磁技術解決現代痛點？\nA. 手機磁場  B. 溫度變化", a:"A"},
  {q:"Sedna™ Gold 含何金屬？\nA. 鈀  B. 鉑", a:"A"},
  {q:"Ceragold™ 技術用於？\nA. 陶瓷+黃金  B. 鋼+陶瓷", a:"A"},
  {q:"Diver 300M 波浪紋如何製作？\nA. 雷射鐫刻  B. 手工雕刻", a:"A"},
  {q:"Aqua Terra 綠色面盤近年流行？\nA. 是  B. 否", a:"A"},
  {q:"超霸陶瓷款稱為？\nA. Dark Side of the Moon  B. White Side", a:"A"},
  {q:"阿波羅8號特別版有何設計？\nA. 月球表面紋理  B. 地球圖案", a:"A"},
  {q:"OMEGA 四大系列中哪個最優雅？\nA. 碟飛  B. 超霸", a:"A"},
  {q:"海馬系列中哪款最專業潛水？\nA. Ultra Deep  B. Aqua Terra", a:"A"},
  {q:"星座系列有無月相功能？\nA. 有  B. 無", a:"A"},
  {q:"超霸系列有無自動上鏈？\nA. 有  B. 無", a:"A"},
  {q:"METAS 認證需測試幾天？\nA. 10天  B. 1天", a:"A"},
  {q:"OMEGA 創立者年齡？\nA. 23歲  B. 30歲", a:"A"},
  {q:"1931年全壘打是指？\nA. 6類第一  B. 3類第一", a:"A"},
  {q:"NASA 測試包含真空環境？\nA. 是  B. 否", a:"A"},
  {q:"馬里亞納海溝深度？\nA. 10,928米  B. 11,000米", a:"A"},
  {q:"超霸系列有無女錶？\nA. 有  B. 無", a:"A"},
  {q:"Diver 300M 錶帶整合式？\nA. 是  B. 否", a:"A"},
  {q:"Aqua Terra 150M 防水？\nA. 150米  B. 300米", a:"A"},
  {q:"Moonwatch 錶鍊可調節？\nA. 是  B. 否", a:"A"},
  {q:"星座系列有無陶瓷錶圈？\nA. 有  B. 無", a:"A"},
  {q:"碟飛系列有無計時功能？\nA. 有  B. 無", a:"A"},
  {q:"Co-Axial 擒縱近乎無摩擦？\nA. 是  B. 否", a:"A"},
  {q:"大師天文台認證包含動力儲存測試？\nA. 是  B. 否", a:"A"},
  {q:"Si14 游絲受溫度影響小？\nA. 是  B. 否", a:"A"},
  {q:"Sedna™ Gold 屬於？\nA. 18K金  B. 14K金", a:"A"},
  {q:"Liquidmetal™ 永不褪色？\nA. 是  B. 否", a:"A"},
  {q:"Diver 300M 白色面盤搭配？\nA. 黑色錶圈  B. 白色錶圈", a:"A"},
  {q:"Planet Ocean 43.5mm 黑橘色？\nA. 經典  B. 新款", a:"A"},
  {q:"Aqua Terra 38mm 綠色面盤？\nA. 時尚  B. 傳統", a:"A"},
  {q:"超霸 Moonshine™ Gold 色澤？\nA. 淡雅  B. 鮮豔", a:"A"},
  {q:"星座系列有無鑽石款？\nA. 有  B. 無", a:"A"},
  {q:"碟飛系列有無月相？\nA. 有  B. 無", a:"A"},
  {q:"OMEGA 抗磁技術領先業界？\nA. 是  B. 否", a:"A"},
  {q:"超霸系列有無GMT功能？\nA. 有  B. 無", a:"A"},
  {q:"海馬系列有無正裝款？\nA. 有  B. 無", a:"A"},
  {q:"星座系列有無潛水功能？\nA. 無  B. 有", a:"A"},
  {q:"碟飛系列有無運動款？\nA. 無  B. 有", a:"A"},
  {q:"Co-Axial 擒縱提升精準度？\nA. 是  B. 否", a:"A"},
  {q:"METAS 測試包含磁場模擬？\nA. 是  B. 否", a:"A"},
  {q:"Diver 300M 錶徑42mm？\nA. 現代  B. 復古", a:"A"},
  {q:"Aqua Terra 柚木面盤有垂直條紋？\nA. 是  B. 否", a:"A"},
  {q:"Moonwatch 藍寶石鏡面可透視？\nA. 機芯  B. 面盤", a:"A"},
  {q:"超霸陶瓷款輕盈耐刮？\nA. 是  B. 否", a:"A"},
  {q:"星座系列有無藍色面盤？\nA. 有  B. 無", a:"A"},
  {q:"碟飛系列有無皮錶帶？\nA. 有  B. 無", a:"A"},
  {q:"OMEGA 四大系列各有特色？\nA. 是  B. 否", a:"A"},
  {q:"超霸系列有無自動計時？\nA. 有  B. 無", a:"A"},
  {q:"海馬系列有無月球錶？\nA. 無  B. 有", a:"A"},
  {q:"星座系列有無測速圈？\nA. 無  B. 有", a:"A"},
  {q:"碟飛系列有無排氦閥？\nA. 無  B. 有", a:"A"},
  {q:"Co-Axial 擒縱延長保養週期？\nA. 是  B. 否", a:"A"},
  {q:"大師天文台認證最嚴苛？\nA. 是  B. 否", a:"A"},
  {q:"Si14 游絲提升穩定性？\nA. 是  B. 否", a:"A"},
  {q:"Sedna™ Gold 色澤溫潤？\nA. 是  B. 否", a:"A"},
  {q:"Liquidmetal™ 平滑耐磨？\nA. 是  B. 否", a:"A"},
  {q:"Diver 300M 橡膠錶帶舒適？\nA. 是  B. 否", a:"A"},
  {q:"Planet Ocean 39.5mm 優雅？\nA. 是  B. 否", a:"A"},
  {q:"Aqua Terra 41mm 藍色面盤？\nA. 商務休閒  B. 專業潛水", a:"A"},
  {q:"Moonwatch 錶鍊重新設計？\nA. 2021年  B. 2018年", a:"A"},
  {q:"超霸38mm 卡布奇諾款溫暖？\nA. 是  B. 否", a:"A"},
  {q:"星座系列托爪是標誌？\nA. 是  B. 否", a:"A"},
  {q:"碟飛系列簡潔雋永？\nA. 是  B. 否", a:"A"},
  {q:"METAS 測試8項？\nA. 是  B. 否", a:"A"},
  {q:"OMEGA 歷史輝煌？\nA. 是  B. 否", a:"A"},
  {q:"超霸系列傳奇？\nA. 是  B. 否", a:"A"},
  {q:"海馬系列強悍？\nA. 是  B. 否", a:"A"},
  {q:"星座系列優雅？\nA. 是  B. 否", a:"A"},
  {q:"碟飛系列頂尖工藝？\nA. 是  B. 否", a:"A"},
  {q:"Co-Axial 革命性？\nA. 是  B. 否", a:"A"},
  {q:"大師天文台認證領先？\nA. 是  B. 否", a:"A"},
  {q:"OMEGA 值得信賴？\nA. 是  B. 否", a:"A"}
  // 共300題
];

// ---------- 狀態 -----------
let pool = [], currentBatch = [], currentQIndex = 0, currentScore = 0, totalRounds = 0;
let currentBatchFailed = false;
const wrongLog = new Map();
const roundSize = 5;
let gameActive = false;

// UI refs
const qmeta = document.getElementById('qmeta'), qtext = document.getElementById('qtext');
const btnA = document.getElementById('btnA'), btnB = document.getElementById('btnB');
const startBtn = document.getElementById('startBtn'), reportBtn = document.getElementById('reportBtn');
const scoreVal = document.getElementById('scoreVal'), progressBar = document.getElementById('progressBar');
const totalRoundsEl = document.getElementById('totalRounds');
const feedbackEl = document.getElementById('feedback');

// ---------- 工具 ----------
function shuffleArray(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } }
function initPool(){ pool = allQuestions.slice(); shuffleArray(pool); }

// 開始新一輪
function startNewRound(){
  if(gameActive && currentQIndex < roundSize) {
    if(!confirm("目前這輪還沒答完，確定要直接開始新的一輪嗎？")) return;
  }

  if(pool.length < roundSize){
      initPool();
      alert("題庫不足！已將所有未通過的題目重新洗牌。");
  }
  
  gameActive = true;
  currentBatchFailed = false;
  
  currentBatch = pool.splice(0, roundSize);
  currentQIndex = 0;
  currentScore = 0;
  updateUIForNewRound();
  showCurrentQuestion();
}

function showCurrentQuestion(){
  if(!gameActive || currentQIndex >= currentBatch.length) return;
  const q = currentBatch[currentQIndex];
  qmeta.textContent = `第 ${currentQIndex + 1} 題（本輪 ${currentQIndex + 1}/${roundSize}）`;
  qtext.textContent = q.q;
  feedbackEl.innerHTML = '';
  updateUI();
}

function updateUI(){
  scoreVal.textContent = currentScore;
  progressBar.style.width = `${(currentQIndex / roundSize) * 100}%`;
  totalRoundsEl.textContent = totalRounds;
  btnA.disabled = !gameActive;
  btnB.disabled = !gameActive;
}

function updateUIForNewRound() {
    feedbackEl.innerHTML = '';
    updateUI();
}

function submitAnswer(userAnswer){
  if(!gameActive) return;
  
  const currentQuestion = currentBatch[currentQIndex];
  const correct = (currentQuestion.a || '').toUpperCase();
  
  if(userAnswer === correct){
    currentScore++;
    feedbackEl.innerHTML = '<div class="ok">正確！</div>';
  } else {
    currentBatchFailed = true;
    if(!wrongLog.has(currentQuestion.q)){
        wrongLog.set(currentQuestion.q, currentQuestion);
    }
    feedbackEl.innerHTML = `<div class="bad">錯誤！正確答案：${correct}</div>`;
  }
  
  updateUI();
  btnA.disabled = true;
  btnB.disabled = true;

  setTimeout(() => {
    currentQIndex++;
    if(currentQIndex < roundSize){
      showCurrentQuestion();
    } else {
      gameActive = false;
      progressBar.style.width = '100%';
      totalRounds++;

      let finalMessage = `本輪結束！您的分數是 ${currentScore}/${roundSize}。`;
      
      if(currentBatchFailed){
          pool.push(...currentBatch);
          shuffleArray(pool);
          finalMessage += " 本輪失敗！5 題將重新進入題庫。";
          feedbackEl.innerHTML = `<div class="bad">${finalMessage}</div>`;
          qtext.textContent = "挑戰失敗！點擊「開始 / 抽新題」重新挑戰這 5 題。";
      } else {
          finalMessage += " 恭喜！本批次 5 題已成功通過！";
          feedbackEl.innerHTML = `<div class="ok">${finalMessage}</div>`;
          qtext.textContent = "挑戰成功！點擊「開始 / 抽新題」挑戰下一批次。";
      }
      
      qmeta.textContent = "本輪已完成";
      updateUI();
    }
  }, 800);
}

function downloadReport(){
  const now = new Date().toLocaleString('zh-TW');
  let report = `歐米伽訓練報告 - ${now}\n總完成輪次: ${totalRounds}\n\n錯題清單 (不重複):\n`;
  if(wrongLog.size === 0){
    report += "無錯題！完美！\n";
  } else {
    let i = 1;
    wrongLog.forEach(w => {
      report += `${i++}. ${w.q}\n   正確答案: ${w.a}\n\n`;
    });
  }
  const blob = new Blob([report], {type: 'text/plain;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `omega_report_${Date.now()}.txt`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// 事件綁定
btnA.addEventListener('click', () => submitAnswer('A'));
btnB.addEventListener('click', () => submitAnswer('B'));
startBtn.addEventListener('click', startNewRound);
reportBtn.addEventListener('click', downloadReport);

// 初始化
function initializeGame() {
    initPool();
    totalRounds = 0;
    totalRoundsEl.textContent = totalRounds;
    scoreVal.textContent = '0';
    progressBar.style.width = '0%';
    startBtn.disabled = false;
}

initializeGame();
</script>
</body>
</html>
